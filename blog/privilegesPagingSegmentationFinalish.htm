<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List
href="privilegesPagingSegmentationFinalish_files/filelist.xml">
<link rel=Preview href="privilegesPagingSegmentationFinalish_files/preview.wmf">
<link rel=Edit-Time-Data
href="privilegesPagingSegmentationFinalish_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Ryan Stankiewicz</o:Author>
  <o:LastAuthor>Ryan Stankiewicz</o:LastAuthor>
  <o:Revision>4</o:Revision>
  <o:TotalTime>33</o:TotalTime>
  <o:Created>2021-01-13T22:00:00Z</o:Created>
  <o:LastSaved>2021-01-13T22:03:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>2928</o:Words>
  <o:Characters>16696</o:Characters>
  <o:Lines>139</o:Lines>
  <o:Paragraphs>39</o:Paragraphs>
  <o:CharactersWithSpaces>19585</o:CharactersWithSpaces>
  <o:Version>16.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<style type="text/css">
	a:link { color: #293145; border-bottom: solid thin #293145; }
	a:visited { color: #666; border-bottom: dotted thin #666; }
	a:hover { color: #666; border-bottom: dotted thin #666; }
	a:active { color: #fff; border-bottom: none; }
	a { text-decoration: none; }
	
	body {
		margin-top: 50px;
		margin-bottom: 20px;
		margin-left: auto;
		margin-right: auto;
		min-width: 40em;
		max-width: 750px;
		border: thin solid #888;
		font-family: Georgia, Cambria, 'Times New Roman', Times, serif;
		font-size: 20px;
		line-height: 1.4;
	}
	
	h2, h3, .heading, .name {
		color: #293145;
		font-family: Arial, sans-serif;
	}
	
	.heading, .name {
		margin: 0;
		text-align: right;
	}
	
	.name {
		font-size: 250%;
		font-weight: bold;
	}
	
	.me {
		font-weight: bold;
		font-style: inherit;
	}
	
	.bibliography {
		margin-left: 2em;
		text-indent: -2em;
	}
	</style>
<link rel=dataStoreItem
href="privilegesPagingSegmentationFinalish_files/item0035.xml"
target="privilegesPagingSegmentationFinalish_files/props036.xml">
<link rel=themeData
href="privilegesPagingSegmentationFinalish_files/themedata.thmx">
<link rel=colorSchemeMapping
href="privilegesPagingSegmentationFinalish_files/colorschememapping.xml">

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-536859905 1073786111 1 0 511 0;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1610601745 1073750139 0 0 511 0;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-469750017 -1073683329 9 0 511 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0in;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
h1
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 1 Char";
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:0pt;
	font-weight:normal;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-priority:39;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-priority:39;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-priority:39;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"Comment Text Char";
	margin:0in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-priority:99;
	mso-style-link:"Header Char";
	margin:0in;
	mso-pagination:widow-orphan;
	tab-stops:center 3.25in right 6.5in;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-priority:99;
	mso-style-link:"Footer Char";
	margin:0in;
	mso-pagination:widow-orphan;
	tab-stops:center 3.25in right 6.5in;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
span.MsoCommentReference
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	margin:0in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:#0563C1;
	mso-themecolor:hyperlink;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:#954F72;
	mso-themecolor:followedhyperlink;
	text-decoration:underline;
	text-underline:single;}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"Comment Text";
	mso-style-link:"Comment Subject Char";
	mso-style-next:"Comment Text";
	margin:0in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"Balloon Text Char";
	margin:0in;
	mso-pagination:widow-orphan;
	font-size:9.0pt;
	font-family:"Segoe UI",sans-serif;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.MsoBibliography, li.MsoBibliography, div.MsoBibliography
	{mso-style-priority:37;
	mso-style-next:Normal;
	margin:0in;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{mso-style-priority:39;
	mso-style-qformat:yes;
	mso-style-parent:"Heading 1";
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	line-height:107%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:16.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Comment Text";
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;}
span.CommentSubjectChar
	{mso-style-name:"Comment Subject Char";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-parent:"Comment Text Char";
	mso-style-link:"Comment Subject";
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;
	font-weight:bold;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Balloon Text";
	mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	font-family:"Segoe UI",sans-serif;
	mso-ascii-font-family:"Segoe UI";
	mso-hansi-font-family:"Segoe UI";
	mso-bidi-font-family:"Segoe UI";}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Title;
	mso-ansi-font-size:28.0pt;
	mso-bidi-font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Footer;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
 /* Page Definitions */
 @page
	{mso-footnote-separator:url("privilegesPagingSegmentationFinalish_files/header.htm") fs;
	mso-footnote-continuation-separator:url("privilegesPagingSegmentationFinalish_files/header.htm") fcs;
	mso-endnote-separator:url("privilegesPagingSegmentationFinalish_files/header.htm") es;
	mso-endnote-continuation-separator:url("privilegesPagingSegmentationFinalish_files/header.htm") ecs;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 @list l0
	{mso-list-id:426080234;
	mso-list-type:hybrid;
	mso-list-template-ids:1499243482 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l0:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l0:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l0:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l0:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l0:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l0:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l0:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l0:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l1
	{mso-list-id:772211460;
	mso-list-type:hybrid;
	mso-list-template-ids:-1483058832 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l1:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l1:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l1:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l2
	{mso-list-id:1216359335;
	mso-list-type:hybrid;
	mso-list-template-ids:-747488634 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l2:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l2:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l2:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l2:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l2:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l2:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l2:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l2:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l3
	{mso-list-id:1428959143;
	mso-list-type:hybrid;
	mso-list-template-ids:-1347156670 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:1.0in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l3:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:1.5in;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l3:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:2.0in;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l3:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:2.5in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l3:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:3.0in;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l3:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:3.5in;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l3:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:4.0in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l3:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:4.5in;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l3:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:5.0in;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l4
	{mso-list-id:1456101809;
	mso-list-type:hybrid;
	mso-list-template-ids:1290855440 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l4:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l4:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l4:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l4:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l4:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l4:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l4:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l4:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l5
	{mso-list-id:1498568177;
	mso-list-type:hybrid;
	mso-list-template-ids:2144008932 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l5:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l5:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l5:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l5:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l5:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l5:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l5:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l5:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l6
	{mso-list-id:1551191286;
	mso-list-type:hybrid;
	mso-list-template-ids:1833491494 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l6:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l6:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l6:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l6:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l6:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l6:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l6:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l6:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l7
	{mso-list-id:1556314928;
	mso-list-type:hybrid;
	mso-list-template-ids:1126354670 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l7:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l7:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l7:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l7:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l7:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l7:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l7:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l7:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l8
	{mso-list-id:1649899904;
	mso-list-type:hybrid;
	mso-list-template-ids:-927324020 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l8:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l8:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l8:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l8:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l8:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l8:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l8:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l8:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l8:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l9
	{mso-list-id:1715033370;
	mso-list-type:hybrid;
	mso-list-template-ids:904282044 67698689 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l9:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l9:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l9:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l10
	{mso-list-id:1742559920;
	mso-list-type:hybrid;
	mso-list-template-ids:-1075259930 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l10:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l10:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l10:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l11
	{mso-list-id:1880822493;
	mso-list-type:hybrid;
	mso-list-template-ids:-1663525226 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l11:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l11:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l11:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l11:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l11:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l11:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l11:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l11:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l11:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l12
	{mso-list-id:1908611144;
	mso-list-type:hybrid;
	mso-list-template-ids:1547199872 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l12:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l12:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l12:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l12:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l12:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l12:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l12:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l12:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l12:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l13
	{mso-list-id:2122913530;
	mso-list-type:hybrid;
	mso-list-template-ids:1069323424 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l13:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l13:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l13:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l13:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l13:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l13:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l13:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l13:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l13:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1031"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link="#0563C1" vlink="#954F72" style='tab-interval:.5in;
word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoTitle>Privileges, Paging, and Segmentation in the Linux Kernel</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<w:Sdt SdtDocPart="t" DocPartType="Table of Contents" DocPartUnique="t"
 ID="673229451">
 <p class=MsoTocHeading>Contents<span style='font-size:11.0pt;line-height:107%;
 mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
 Calibri;mso-fareast-theme-font:minor-latin;mso-hansi-font-family:Calibri;
 mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";
 mso-bidi-theme-font:minor-bidi;color:windowtext'><w:sdtPr></w:sdtPr></span></p>
 <p class=MsoToc1 style='tab-stops:right dotted 467.5pt'><!--[if supportFields]><span
 style='mso-element:field-begin'></span><span
 style='mso-spacerun:yes'>ï¿½</span>TOC \o &quot;1-3&quot; \h \z \u <span
 style='mso-element:field-separator'></span><![endif]--><span
 class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc61449159">Introduction<span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'><span style='mso-element:field-begin'></span></span><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'> PAGEREF _Toc61449159 \h </span><span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-element:field-separator'></span></span><![endif]--><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'>1</span><span style='color:windowtext;display:none;
 mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300360031003400340039003100350039000000</w:data>
 </xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
 style='mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:minor-fareast;
 mso-no-proof:yes'><o:p></o:p></span></p>
 <p class=MsoToc1 style='tab-stops:right dotted 467.5pt'><span
 class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc61449160">Segmentation<span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'><span style='mso-element:field-begin'></span></span><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'> PAGEREF _Toc61449160 \h </span><span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-element:field-separator'></span></span><![endif]--><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'>2</span><span style='color:windowtext;display:none;
 mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300360031003400340039003100360030000000</w:data>
 </xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
 style='mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:minor-fareast;
 mso-no-proof:yes'><o:p></o:p></span></p>
 <p class=MsoToc1 style='tab-stops:right dotted 467.5pt'><span
 class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc61449161">Minimal
 Use of Segmentation in the Linux Kernel<span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'><span style='mso-element:field-begin'></span></span><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'> PAGEREF _Toc61449161 \h </span><span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-element:field-separator'></span></span><![endif]--><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'>6</span><span style='color:windowtext;display:none;
 mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300360031003400340039003100360031000000</w:data>
 </xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
 style='mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:minor-fareast;
 mso-no-proof:yes'><o:p></o:p></span></p>
 <p class=MsoToc1 style='tab-stops:right dotted 467.5pt'><span
 class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc61449162">Paging
 in Linux<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
 none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'><span style='mso-element:field-begin'></span></span><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'> PAGEREF _Toc61449162 \h </span><span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-element:field-separator'></span></span><![endif]--><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'>7</span><span style='color:windowtext;display:none;
 mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300360031003400340039003100360032000000</w:data>
 </xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
 style='mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:minor-fareast;
 mso-no-proof:yes'><o:p></o:p></span></p>
 <p class=MsoToc1 style='tab-stops:right dotted 467.5pt'><span
 class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc61449163">Quick
 Recap of Privilege Checking<span style='color:windowtext;display:none;
 mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'><span style='mso-element:field-begin'></span></span><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'> PAGEREF _Toc61449163 \h </span><span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-element:field-separator'></span></span><![endif]--><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'>11</span><span style='color:windowtext;display:none;
 mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300360031003400340039003100360033000000</w:data>
 </xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
 style='mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:minor-fareast;
 mso-no-proof:yes'><o:p></o:p></span></p>
 <p class=MsoToc1 style='tab-stops:right dotted 467.5pt'><span
 class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc61449164">References<span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'><span style='mso-element:field-begin'></span></span><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'> PAGEREF _Toc61449164 \h </span><span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-element:field-separator'></span></span><![endif]--><span
 style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
 text-underline:none'>12</span><span style='color:windowtext;display:none;
 mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300360031003400340039003100360034000000</w:data>
 </xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
 display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
 style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
 style='mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:minor-fareast;
 mso-no-proof:yes'><o:p></o:p></span></p>
 <p class=MsoNormal><!--[if supportFields]><b><span style='mso-no-proof:yes'><span
 style='mso-element:field-end'></span></span></b><![endif]--><o:p>&nbsp;</o:p></p>
</w:Sdt>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc61449159">Introduction</a></h1>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b>The purpose of this post is to explore how the Linux
Kernel implements User mode and Kernel mode privileges on the Intel x86 family
of processors.<span style='mso-spacerun:yes'>ï¿½ </span></b>When I first learned
about this topic, it was not immediately clear how paging and segmentation
worked together when it came to privileges.<span style='mso-spacerun:yes'>ï¿½
</span>In fact, I incorrectly thought that segmentation was entirely disabled
by the Linux Kernel, which is a somewhat true (yet misleading) statement
commonly found online<b>.</b><span style='mso-spacerun:yes'>ï¿½ </span>If you
havenï¿½t heard about protection rings or the concept of User mode and Kernel
mode, the next paragraph should provide enough of an intro that youï¿½ll be able
to understand the rest of this post (although Iï¿½d also recommend reading <a
href="https://blog.codinghorror.com/understanding-user-and-kernel-mode/">this
article</a> if you have time).<span style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><!--[if gte vml 1]><v:rect id="Rectangle_x0020_19" o:spid="_x0000_s1030"
 style='position:absolute;margin-left:-9pt;margin-top:4.5pt;width:1395pt;
 height:126pt;z-index:-251657216;visibility:visible;mso-wrap-style:square;
 mso-width-percent:0;mso-height-percent:0;mso-wrap-distance-left:9pt;
 mso-wrap-distance-top:0;mso-wrap-distance-right:9pt;
 mso-wrap-distance-bottom:0;mso-position-horizontal:absolute;
 mso-position-horizontal-relative:margin;mso-position-vertical:absolute;
 mso-position-vertical-relative:text;mso-width-percent:0;mso-height-percent:0;
 mso-width-relative:margin;mso-height-relative:margin;v-text-anchor:middle'
 o:gfxdata="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
" fillcolor="#d9e2f3 [660]" strokecolor="#1f3763 [1604]" strokeweight="1pt">
 <w:wrap anchorx="margin"/>
</v:rect><![endif]--><![if !vml]><span style='mso-ignore:vglayout;position:
absolute;z-index:-1895824384;margin-left:-13px;margin-top:5px;width:1862px;
height:170px'><img width=1862 height=170
src="privilegesPagingSegmentationFinalish_files/image001.png" v:shapes="Rectangle_x0020_19"></span><![endif]></p>

<p class=MsoNormal><b>Quick Summary of User Mode vs Kernel Mode:<span
style='mso-spacerun:yes'>ï¿½ </span><o:p></o:p></b></p>

<p class=MsoNormal>One of the most important tasks of the Linux Kernel is to
ensure that user processes (e.g. a Python script) do not overstep their
boundaries.<span style='mso-spacerun:yes'>ï¿½ </span>To maintain a secure system,
the Kernel must make some restrictions on user processes.<o:p></o:p></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:1.0in;mso-add-space:auto;
text-indent:-.25in;mso-list:l3 level1 lfo5'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>User processes should not have the ability to
directly access the underlying hardware<o:p></o:p></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;mso-add-space:
auto;text-indent:-.25in;mso-list:l3 level1 lfo5'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>User processes should not be able to access all
possible memory addresses<o:p></o:p></p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;mso-add-space:auto;
text-indent:-.25in;mso-list:l3 level1 lfo5'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>User processes should not be able to access
Kernel code or Kernel data structures<o:p></o:p></p>

<p class=MsoNormal>The Linux Kernel implements these restrictions by
maintaining two different modes in which processes can run, User mode or Kernel
mode.<span style='mso-spacerun:yes'>ï¿½ </span>In User mode, the above
restrictions apply.<span style='mso-spacerun:yes'>ï¿½ </span>However, in Kernel
mode, these restrictions do not apply.<span style='mso-spacerun:yes'>ï¿½ </span>A
process in Kernel mode can access any memory address and execute any CPU
instruction.<span style='mso-spacerun:yes'>ï¿½ </span>Therefore, it can also
access Kernel code and Kernel data structures.<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>To understand how privileges are implemented in the Linux
Kernel, you have to understand the basics of segmentation and paging. Both of these
are memory addressing techniques implemented via hardware (<a
href="https://en.wikipedia.org/wiki/Memory_management_unit">the memory
management unit</a>, or MMU) and software (the operating system).<span
style='mso-spacerun:yes'>ï¿½ </span>First, Iï¿½ll cover the basics of segmentation
and its relevance to privileges.<span style='mso-spacerun:yes'>ï¿½ </span>Then
Iï¿½ll move to the basics of paging.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Before diving in, I want to emphasize the fact that we will
discuss three different types of memory addresses in the following
sections.<span style='mso-spacerun:yes'>ï¿½ </span>Logical addresses, linear
addresses, and physical addresses.<span style='mso-spacerun:yes'>ï¿½
</span>Logical addresses are what appear in machine level instructions and in
code.<span style='mso-spacerun:yes'>ï¿½ </span>The segmentation unit (a circuit
within the MMU) converts these to linear addresses, which are used in
paging.<span style='mso-spacerun:yes'>ï¿½ </span>The paging unit (also a circuit within
the MMU) then converts these to physical addresses, which end up as the electrical
inputs to the address pins of the memory controller.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="Picture_x0020_11" o:spid="_x0000_i1036" type="#_x0000_t75"
 style='width:459.75pt;height:225.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="privilegesPagingSegmentationFinalish_files/image002.png"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=613 height=301
src="privilegesPagingSegmentationFinalish_files/image003.jpg" v:shapes="Picture_x0020_11"><![endif]></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>I should also note that most of the research Iï¿½ve done into
this topic was guided by the book <i>Understanding the Linux Kernel, 3<sup>rd</sup>
Edition,</i> by Daniel P. Bovet and Marco Cesati <w:Sdt Citation="t"
 ID="-900368846"><!--[if supportFields]><span style='mso-element:field-begin'></span><i><span
 style='mso-spacerun:yes'>ï¿½</span>CITATION Bov051 \l 1033 </i><span
 style='mso-element:field-separator'></span><![endif]--><span style='mso-no-proof:
 yes'>[1]</span><!--[if supportFields]><span style='mso-element:field-end'></span><![endif]--></w:Sdt>.<span
style='mso-spacerun:yes'>ï¿½ </span>If you want a more in depth look into these
topics, I highly recommend reading this book, specifically chapter 2 (memory
addressing).<span style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc61449160">Segmentation</a> </h1>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Intel first developed segmentation in the 8086
microprocessor (1976)<span style='mso-spacerun:yes'>ï¿½ </span><w:Sdt Citation="t"
 ID="-942141141"><!--[if supportFields]><span style='mso-element:field-begin'></span><span
 style='mso-spacerun:yes'>ï¿½</span>CITATION Int21 \l 1033 <span
 style='mso-element:field-separator'></span><![endif]--><span style='mso-no-proof:
 yes'>[2]</span><!--[if supportFields]><span style='mso-element:field-end'></span><![endif]--></w:Sdt>.<span
style='mso-spacerun:yes'>ï¿½ </span>The goal of segmentation was to ensure that developers
split their programs into logical pieces (e.g. functions and global data).<span
style='mso-spacerun:yes'>ï¿½ </span>Segmentation splits the entire range of
linear memory addresses into different segments.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_12" o:spid="_x0000_i1035" type="#_x0000_t75" style='width:342pt;
 height:212.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="privilegesPagingSegmentationFinalish_files/image004.png"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=456 height=283
src="privilegesPagingSegmentationFinalish_files/image005.jpg" v:shapes="Picture_x0020_12"><![endif]></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>ï¿½</span></p>

<p class=MsoNormal>The segmentation unit, a circuit within a processorï¿½s memory
management unit, handles the task of translating a <b>logical address</b> to a <b>linear
address</b>.<span style='mso-spacerun:yes'>ï¿½ </span>The logical address is
generated by the CPU and is what our program works with.<span
style='mso-spacerun:yes'>ï¿½ </span>The linear address is what the paging unit
takes as input (more on this later).<span style='mso-spacerun:yes'>ï¿½ </span>Here
is a visual which describes the translation of logical to linear addresses. </p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_13" o:spid="_x0000_i1034" type="#_x0000_t75" style='width:468pt;
 height:261.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="privilegesPagingSegmentationFinalish_files/image006.png"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=624 height=349
src="privilegesPagingSegmentationFinalish_files/image007.jpg" v:shapes="Picture_x0020_13"><![endif]></span><w:Sdt
 Citation="t" ID="1093517441"><!--[if supportFields]><span style='mso-element:
 field-begin'></span><span style='mso-spacerun:yes'>ï¿½</span>CITATION Bov05 \l
 1033 <span style='mso-element:field-separator'></span><![endif]--><span
 style='mso-no-proof:yes'><span style='mso-spacerun:yes'>ï¿½</span>[3]</span><!--[if supportFields]><span
 style='mso-element:field-end'></span><![endif]--></w:Sdt></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>A logical address consists of two parts: a segment selector
and an offset, which we see near the bottom of the above figure.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The first part of the logical address, the segment selector,
is used to determine which segment a given logical address is in.<span
style='mso-spacerun:yes'>ï¿½ï¿½ </span>In both 32-bit and 64-bit architectures, the
segment selector is 16-bits.<span style='mso-spacerun:yes'>ï¿½ </span>This
indexes into either the <b>Global Descriptor Table</b> <b>(GDT)</b> or a <b>Local
Descriptor Table (LDT).<span style='mso-spacerun:yes'>ï¿½ </span></b>Both the GDT
and the LDT contain <b>segment descriptors</b> which describe different
available segments of memory (remember, a segment is just a region of memory in
the linear address space).<span style='mso-spacerun:yes'>ï¿½ </span>The GDT is
global to all processes, while the LDT is local to a single process and is used
in the case where that process needs additional segments.<span
style='mso-spacerun:yes'>ï¿½ </span>However, since most processes donï¿½t make use
of their own LDT, the Kernel assigns processes a shared LDT by default.<b><span
style='mso-spacerun:yes'>ï¿½ </span></b>To determine which table a given segment
is in, the selector also contains a field called the Table Indicator (TI).<span
style='mso-spacerun:yes'>ï¿½ </span>This field specifies whether the segment
descriptor is included in the GDT (TI = 0) or in the LDT (TI = 1).<b><o:p></o:p></b></p>

<p class=MsoNormal><!--[if gte vml 1]><v:rect id="Rectangle_x0020_20" o:spid="_x0000_s1029"
 style='position:absolute;margin-left:-12pt;margin-top:15.75pt;width:976.5pt;
 height:491.25pt;z-index:-251656192;visibility:visible;mso-wrap-style:square;
 mso-width-percent:0;mso-height-percent:0;mso-wrap-distance-left:9pt;
 mso-wrap-distance-top:0;mso-wrap-distance-right:9pt;
 mso-wrap-distance-bottom:0;mso-position-horizontal:absolute;
 mso-position-horizontal-relative:text;mso-position-vertical:absolute;
 mso-position-vertical-relative:text;mso-width-percent:0;mso-height-percent:0;
 mso-width-relative:margin;mso-height-relative:margin;v-text-anchor:middle'
 o:gfxdata="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
" fillcolor="#d9e2f3 [660]" strokecolor="#1f3763 [1604]" strokeweight="1pt"/><![endif]--><![if !vml]><span
style='mso-ignore:vglayout;position:absolute;z-index:-1895823360;margin-left:
-17px;margin-top:19px;width:1304px;height:658px'><img width=1304 height=658
src="privilegesPagingSegmentationFinalish_files/image008.png" v:shapes="Rectangle_x0020_20"></span><![endif]></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The code that performs the check of the TI field is in the
file<i> <a
href="https://elixir.bootlin.com/linux/v5.8/source/arch/x86/events/core.c#L2459">/arch/x86/events/core.c</a>.<span
style='mso-spacerun:yes'>ï¿½ </span><o:p></o:p></i></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_3" o:spid="_x0000_i1033" type="#_x0000_t75" style='width:436.5pt;
 height:287.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="privilegesPagingSegmentationFinalish_files/image009.png"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=582 height=383
src="privilegesPagingSegmentationFinalish_files/image010.jpg" v:shapes="Picture_x0020_3"><![endif]></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The if statement on line 2459 is where this check
occurs.<span style='mso-spacerun:yes'>ï¿½ </span>As with most macros regarding
segmentation, ï¿½SEGMENT_TI_MASKï¿½ and ï¿½SEGMENT_LDTï¿½ are defined in the file<i> <a
href="https://elixir.bootlin.com/linux/v5.8/source/arch/x86/include/asm/segment.h#L50">/arch/x86/include/asm/segment.h</a>.<o:p></o:p></i></p>

<p class=MsoNormal><i><o:p>&nbsp;</o:p></i></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_6" o:spid="_x0000_i1032" type="#_x0000_t75" style='width:467.25pt;
 height:88.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="privilegesPagingSegmentationFinalish_files/image011.png"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=623 height=118
src="privilegesPagingSegmentationFinalish_files/image011.png" v:shapes="Picture_x0020_6"><![endif]></span><i><o:p></o:p></i></p>

<p class=MsoNormal><b><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal><b><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal><b><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal><b><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>ï¿½ </span><span
style='mso-spacerun:yes'>ï¿½ï¿½</span></p>

<p class=MsoNormal>Here are a few important fields that a given segment descriptor
will contain:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l6 level1 lfo6'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The linear address of the first byte of the segment</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l6 level1 lfo6'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The offset of the last memory address in the
segment</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l6 level1 lfo6'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b>The Descriptor Privilege Level (DPL)</b> of
the segment.<span style='mso-spacerun:yes'>ï¿½ </span>This is the minimum CPU
privilege level required for accessing the segment</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l6 level1 lfo6'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The type of the segment.<span
style='mso-spacerun:yes'>ï¿½ </span>This describes the type of data stored in a segment.<span
style='mso-spacerun:yes'>ï¿½ </span>It can be a code segment, a data segment,
something called a task state segment, or a Local Descriptor Table segment</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The segment descriptor format is defined in the file <a
href="https://elixir.bootlin.com/linux/v5.8/source/arch/x86/include/asm/desc_defs.h#L19"><i>/arch/x86/include/asm/desc_defs.h</i></a><i>.<o:p></o:p></i></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_5" o:spid="_x0000_i1031" type="#_x0000_t75" style='width:399pt;
 height:109.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="privilegesPagingSegmentationFinalish_files/image012.png"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=532 height=146
src="privilegesPagingSegmentationFinalish_files/image012.png" v:shapes="Picture_x0020_5"><![endif]></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Hereï¿½s a short summary of the logical address translation
process performed by the segmentation unit.<span style='mso-spacerun:yes'>ï¿½
</span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l1 level1 lfo10'><![if !supportLists]><span
style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin'><span
style='mso-list:Ignore'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The segmentation unit looks at the TI of a given
segment selector and determines whether the desired segment descriptor is
located in the GDT or LDT.<span style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l1 level1 lfo10'><![if !supportLists]><span
style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin'><span
style='mso-list:Ignore'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The desired segment descriptor is then addressed
by multiplying the index field of the segment selector by 8 and adding this to
the base address of the relevant descriptor table.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l1 level1 lfo10'><![if !supportLists]><span
style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin'><span
style='mso-list:Ignore'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The offset field of the logical address is added
to the linear address of the first byte of the segment described by the
specified segment descriptor.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>One last point I want to touch on before diving into
privileges and segmentation specifically is that there are a set of registers (in
the Intel x86 family of processors) called <b>segmentation registers</b>.<span
style='mso-spacerun:yes'>ï¿½ </span>These hold predetermined segment selectors so
that programs can more easily access frequently used segments.<span
style='mso-spacerun:yes'>ï¿½ </span>These are some important segmentation
registers:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l4 level1 lfo11'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>the code segment register which points to a
segment containing the currently executing processï¿½s instructions (CS)</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l4 level1 lfo11'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>the stack segment register which points to the
segment containing the currently executing processï¿½s stack (SS)</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l4 level1 lfo11'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>the data segment register which contains global
and static data for the currently executing process (DS)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Now I want to focus in on privileges and segmentation. </p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Iï¿½ve already touched on one important piece, Descriptor
Privilege Levels.<span style='mso-spacerun:yes'>ï¿½ </span>This is a field
associated with each segment that describes the minimum CPU privilege level that
is required to access the segment.<span style='mso-spacerun:yes'>ï¿½ </span>The
CPUï¿½s current privilege level is stored in the code segment register, which
points to the segment containing the currently executing programï¿½s code.<span
style='mso-spacerun:yes'>ï¿½ </span>This register contains a 2-bit field which
specifies the Current Privilege Level (CPL) of the CPU.<span
style='mso-spacerun:yes'>ï¿½ </span>Zero is the highest privilege level (Kernel
Mode) while 3 is the lowest privilege level (User Mode).</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>This is great; segmentation gives the Linux Kernel a way of
enforcing privilege checks.<span style='mso-spacerun:yes'>ï¿½ </span>For a
program to access a segment, the program must have a higher or equal CPL than
that segmentï¿½s DPL.<span style='mso-spacerun:yes'>ï¿½ </span>However, I want to
run through the following scenario which describes why we need one more
privilege check in addition to the DPL and CPL check.<span
style='mso-spacerun:yes'>ï¿½ </span>This scenario comes from the following
article which I highly recommend reading, <a
href="https://openwares.net/2019/02/09/cpl-vs-dpl-vs-rpl/">https://openwares.net/2019/02/09/cpl-vs-dpl-vs-rpl/</a><span
class=MsoHyperlink> <w:Sdt Citation="t" ID="-851411277"><!--[if supportFields]><span
 style='mso-element:field-begin'></span><span
 style='mso-spacerun:yes'>ï¿½</span>CITATION CPL20 \l 1033 <span
 style='mso-element:field-separator'></span><![endif]--><span style='mso-no-proof:
 yes;text-decoration:none;text-underline:none'>[4]</span><!--[if supportFields]><span
 style='mso-element:field-end'></span><![endif]--></w:Sdt> </span>.<span
style='mso-spacerun:yes'>ï¿½ </span><span style='mso-spacerun:yes'>ï¿½</span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Imagine a User mode program that makes a system call.<span
style='mso-spacerun:yes'>ï¿½ </span>This system call takes a memory address as an
argument and writes to that address.<span style='mso-spacerun:yes'>ï¿½
</span>Letï¿½s imagine that the User Mode program passes in the address of a
kernel data structure to the system call.<span style='mso-spacerun:yes'>ï¿½
</span>Normally, the User Mode process should not be able to write directly to
this kernel data structure, even through a system call.<span
style='mso-spacerun:yes'>ï¿½ </span>However, with only DPL and CPL checks, the User
Mode program would be able to indirectly access this data structure since system
calls run in Kernel mode.<span style='mso-spacerun:yes'>ï¿½ </span>To avoid this
error and security issue, there is a privilege associated with each segment
selector called the Requestor Privilege Level.<span style='mso-spacerun:yes'>ï¿½
</span>This is a field within the segment selector of a logical address.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>To summarize, access to a given segment is authorized only
if both the following checks are successful:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l8 level1 lfo7'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>CPL &lt;= DPL</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l8 level1 lfo7'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>RPL &lt;= DPL</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc61449161">Minimal Use of Segmentation in the Linux Kernel</a></h1>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>It turns out that the Linux Kernel doesnï¿½t like to use
segmentation that much.<span style='mso-spacerun:yes'>ï¿½ </span>The Linux Kernel
prefers paging over segmentation as memory management turns out to be easier
when all processes share the same set of linear addresses.<span
style='mso-spacerun:yes'>ï¿½ </span>Paging is also much more portable across
processors than segmentation is.<span style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>So how does Linux bypass segmentation for everything but
privilege checking?<span style='mso-spacerun:yes'>ï¿½ </span>Hereï¿½s a table that
describes the four main segments in the Kernel.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_10" o:spid="_x0000_i1030" type="#_x0000_t75" style='width:423.75pt;
 height:231pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="privilegesPagingSegmentationFinalish_files/image013.png"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=565 height=308
src="privilegesPagingSegmentationFinalish_files/image014.jpg" v:shapes="Picture_x0020_10"><![endif]></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Notice that all these segments share the same base linear
address.<span style='mso-spacerun:yes'>ï¿½ </span>This means that logical and
linear addresses are equivalent.<span style='mso-spacerun:yes'>ï¿½ </span>This allows
the Linux Kernel to use paging as the preferred technique of memory
addressing.<span style='mso-spacerun:yes'>ï¿½ </span>However, despite having the
same base addresses, these segments still have differing Descriptor Privilege
Levels.<span style='mso-spacerun:yes'>ï¿½ </span>Thus, when attempting to access
a given linear address, the segment containing the address is still relevant.<span
style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoNormal><!--[if gte vml 1]><v:rect id="Rectangle_x0020_21" o:spid="_x0000_s1028"
 style='position:absolute;margin-left:-5.25pt;margin-top:5.15pt;width:723.75pt;
 height:198.75pt;z-index:-251655168;visibility:visible;mso-wrap-style:square;
 mso-width-percent:0;mso-height-percent:0;mso-wrap-distance-left:9pt;
 mso-wrap-distance-top:0;mso-wrap-distance-right:9pt;
 mso-wrap-distance-bottom:0;mso-position-horizontal:absolute;
 mso-position-horizontal-relative:text;mso-position-vertical:absolute;
 mso-position-vertical-relative:text;mso-width-percent:0;mso-height-percent:0;
 mso-width-relative:margin;mso-height-relative:margin;v-text-anchor:middle'
 o:gfxdata="UEsDBBQABgAIAAAAIQC2gziS/gAAAOEBAAATAAAAW0NvbnRlbnRfVHlwZXNdLnhtbJSRQU7DMBBF
90jcwfIWJU67QAgl6YK0S0CoHGBkTxKLZGx5TGhvj5O2G0SRWNoz/78nu9wcxkFMGNg6quQqL6RA
0s5Y6ir5vt9lD1JwBDIwOMJKHpHlpr69KfdHjyxSmriSfYz+USnWPY7AufNIadK6MEJMx9ApD/oD
OlTrorhX2lFEilmcO2RdNtjC5xDF9pCuTyYBB5bi6bQ4syoJ3g9WQ0ymaiLzg5KdCXlKLjvcW893
SUOqXwnz5DrgnHtJTxOsQfEKIT7DmDSUCaxw7Rqn8787ZsmRM9e2VmPeBN4uqYvTtW7jvijg9N/y
JsXecLq0q+WD6m8AAAD//wMAUEsDBBQABgAIAAAAIQA4/SH/1gAAAJQBAAALAAAAX3JlbHMvLnJl
bHOkkMFqwzAMhu+DvYPRfXGawxijTi+j0GvpHsDYimMaW0Yy2fr2M4PBMnrbUb/Q94l/f/hMi1qR
JVI2sOt6UJgd+ZiDgffL8ekFlFSbvV0oo4EbChzGx4f9GRdb25HMsYhqlCwG5lrLq9biZkxWOiqY
22YiTra2kYMu1l1tQD30/bPm3wwYN0x18gb45AdQl1tp5j/sFB2T0FQ7R0nTNEV3j6o9feQzro1i
OWA14Fm+Q8a1a8+Bvu/d/dMb2JY5uiPbhG/ktn4cqGU/er3pcvwCAAD//wMAUEsDBBQABgAIAAAA
IQCZepgomAIAAK4FAAAOAAAAZHJzL2Uyb0RvYy54bWysVE1v2zAMvQ/YfxB0Xx0bSdcGdYqgRYcB
XVu0HXpWZSk2IImapMTJfv0oyXGDfuww7CKLFPlIPpM8O99qRTbC+Q5MTcujCSXCcGg6s6rpz8er
LyeU+MBMwxQYUdOd8PR88fnTWW/nooIWVCMcQRDj572taRuCnReF563QzB+BFQYfJTjNAopuVTSO
9YiuVVFNJsdFD66xDrjwHrWX+ZEuEr6UgodbKb0IRNUUcwvpdOl8jmexOGPzlWO27fiQBvuHLDTr
DAYdoS5ZYGTtujdQuuMOPMhwxEEXIGXHRaoBqyknr6p5aJkVqRYkx9uRJv//YPnN5s6RrqlpVVJi
mMZ/dI+sMbNSgqAOCeqtn6Pdg71zg+TxGqvdSqfjF+sg20TqbiRVbAPhqDwtT8vjakYJx7dqVk1L
FBCneHG3zodvAjSJl5o6jJ/IZJtrH7Lp3iRG86C65qpTKgmxU8SFcmTD8B8zzoUJZXJXa/0DmqzH
XpkMfxvV2BNZfbJXYzap5yJSyu0gSBEJyCWnW9gpEUMrcy8kcodFVingiPA2F9+yRmT17MOYCTAi
SyxuxM7FfICd2Rnso6tITT86T/6WWHYePVJkMGF01p0B9x6AQoaHyNkeKTugJl6fodlhZznII+ct
v+rw714zH+6YwxnDacS9EW7xkAr6msJwo6QF9/s9fbTH1sdXSnqc2Zr6X2vmBCXqu8GhOC2n0zjk
SZjOvlYouMOX58MXs9YXgC2DfY/ZpWu0D2p/lQ70E66XZYyKT8xwjF1THtxeuAh5l+CC4mK5TGY4
2JaFa/NgeQSPrMbufdw+MWeHFg84HTewn282f9Xp2TZ6GliuA8gujcELrwPfuBRSsw4LLG6dQzlZ
vazZxR8AAAD//wMAUEsDBBQABgAIAAAAIQAEYYFL4AAAAAsBAAAPAAAAZHJzL2Rvd25yZXYueG1s
TI9BTsMwEEX3SNzBGiQ2qLVD27QKcapQiQULFi05gBsPSUQ8DrHbhtszXdHl6D/9eT/fTq4XZxxD
50lDMlcgkGpvO2o0VJ9vsw2IEA1Z03tCDb8YYFvc3+Ums/5CezwfYiO4hEJmNLQxDpmUoW7RmTD3
AxJnX350JvI5NtKO5sLlrpfPSqXSmY74Q2sG3LVYfx9OTsPuPVlV6c9HUr6W8alyptkPaan148NU
voCIOMV/GK76rA4FOx39iWwQvYZZolaMcqAWIK7AcrHmdUcNS7XegCxyebuh+AMAAP//AwBQSwEC
LQAUAAYACAAAACEAtoM4kv4AAADhAQAAEwAAAAAAAAAAAAAAAAAAAAAAW0NvbnRlbnRfVHlwZXNd
LnhtbFBLAQItABQABgAIAAAAIQA4/SH/1gAAAJQBAAALAAAAAAAAAAAAAAAAAC8BAABfcmVscy8u
cmVsc1BLAQItABQABgAIAAAAIQCZepgomAIAAK4FAAAOAAAAAAAAAAAAAAAAAC4CAABkcnMvZTJv
RG9jLnhtbFBLAQItABQABgAIAAAAIQAEYYFL4AAAAAsBAAAPAAAAAAAAAAAAAAAAAPIEAABkcnMv
ZG93bnJldi54bWxQSwUGAAAAAAQABADzAAAA/wUAAAAA
" fillcolor="#d9e2f3 [660]" strokecolor="#1f3763 [1604]" strokeweight="1pt"/><![endif]--><![if !vml]><span
style='mso-ignore:vglayout;position:absolute;z-index:-1895822336;margin-left:
-8px;margin-top:5px;width:967px;height:268px'><img width=967 height=268
src="privilegesPagingSegmentationFinalish_files/image015.png" v:shapes="Rectangle_x0020_21"></span><![endif]></p>

<p class=MsoNormal>To access the segment descriptors for these segments, the
Kernel provides programmers a set of macros which define the proper segment
selector values.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_4" o:spid="_x0000_i1029" type="#_x0000_t75" style='width:468pt;
 height:124.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="privilegesPagingSegmentationFinalish_files/image016.png"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=624 height=166
src="privilegesPagingSegmentationFinalish_files/image017.jpg" v:shapes="Picture_x0020_4"><![endif]></span><span
style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>You can find these in the file <a
href="https://elixir.bootlin.com/linux/v5.8/source/arch/x86/include/asm/segment.h"><i>/arch/x86/include/asm/segment.h</i></a><i>.<o:p></o:p></i></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Now that we understand how the Kernel makes (minimal) use of
segmentation for privilege checking, I want to dive into paging.<span
style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc61449162">Paging in Linux</a></h1>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Paging is another memory addressing technique that is preferred
over segmentation by the Kernel.<span style='mso-spacerun:yes'>ï¿½ </span>Inside
the processorï¿½s memory management unit is the paging unit.<span
style='mso-spacerun:yes'>ï¿½ </span>This unit handles the translation of linear
addresses to physical addresses.<span style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The foundational concept in paging is a page.<span
style='mso-spacerun:yes'>ï¿½ </span>A page is a grouped fixed-length interval of
linear addresses.<span style='mso-spacerun:yes'>ï¿½ </span>The paging unit sees
RAM as partitioned into fixed-length page frames.<span
style='mso-spacerun:yes'>ï¿½ </span>Each of these page frames can contain a
single page of data.<span style='mso-spacerun:yes'>ï¿½ </span>Essentially, a page
is just a block of data and a page frame is a place to store this block of
data.<span style='mso-spacerun:yes'>ï¿½ </span>This allows a page to be stored in
a page frame in RAM, then evacuated from RAM and saved to a disk, and later
reloaded into a different page frame in RAM.<span style='mso-spacerun:yes'>ï¿½
</span>This is a foundational concept behind virtual memory (a topic that will be
explored further in future posts).</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Here is an image which shows an example of a processï¿½s
linear address space.<span style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_9" o:spid="_x0000_i1028" type="#_x0000_t75" style='width:468pt;
 height:208.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="privilegesPagingSegmentationFinalish_files/image018.png"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=624 height=278
src="privilegesPagingSegmentationFinalish_files/image019.jpg" v:shapes="Picture_x0020_9"><![endif]></span>On
the right we see the physical memory (RAM).<span style='mso-spacerun:yes'>ï¿½
</span>Each rectangle within the processï¿½s linear address space on the left is
a page.<span style='mso-spacerun:yes'>ï¿½ </span>Some of these are mapped to a
page frame in physical memory (cached) and others are not and may be on disk
instead (uncached).<span style='mso-spacerun:yes'>ï¿½ </span>Pages that arenï¿½t
backed by disk or RAM are unallocated.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>To translate a linear address in a processï¿½s address space
to its location in physical memory, the Kernel uses a series of data structures
stored in memory.<span style='mso-spacerun:yes'>ï¿½ </span>These data structures
are referred to as translation tables, or page tables.<span
style='mso-spacerun:yes'>ï¿½ </span>The Linux Kernel configures Intel x86
processors to use a four-level paging scheme, which means that we have four
layers of these translation tables.<span style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Letï¿½s look at how a linear address is split up and how these
tables work.</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>ï¿½</span></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_1" o:spid="_x0000_i1027" type="#_x0000_t75" style='width:468pt;
 height:266.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="privilegesPagingSegmentationFinalish_files/image020.png"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=624 height=355
src="privilegesPagingSegmentationFinalish_files/image021.jpg" v:shapes="Picture_x0020_1"><![endif]></span></p>

<p class=MsoNormal><w:Sdt Citation="t" ID="546732801"><!--[if supportFields]><span
 style='mso-element:field-begin'></span><span
 style='mso-spacerun:yes'>ï¿½</span>CITATION Fou05 \l 1033 <span
 style='mso-element:field-separator'></span><![endif]--><span style='mso-no-proof:
 yes'>[5]</span><!--[if supportFields]><span style='mso-element:field-end'></span><![endif]--></w:Sdt></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Each process has its own set of page tables which are stored
in memory.<span style='mso-spacerun:yes'>ï¿½ </span>The first layer of this
paging process is the Page Global Directory (PGD) data structure.<span
style='mso-spacerun:yes'>ï¿½ </span>Since 8 bits of a linear address are
dedicated as an index into that processï¿½s PGD, we know that the processï¿½s PGD
has 2^8, or 256 entries.<span style='mso-spacerun:yes'>ï¿½ </span>Each entry in a
PGD points to a page frame in memory containing a Page Upper Directory (PUD). <span
style='mso-spacerun:yes'>ï¿½</span>Each entry in a PUD (of which there are 256)
points to a page frame containing a Page Middle Directory (PMD).<span
style='mso-spacerun:yes'>ï¿½ </span>Each PMD also has 256 entries, each of which
point to a Page Table.<span style='mso-spacerun:yes'>ï¿½ </span>A Page Table also
has 256 entries.<span style='mso-spacerun:yes'>ï¿½ </span>Instead of pointing to
another layer of translation tables, each entry in a Page Table contains the physical
address of the page frame containing the page corresponding to our linear
address.<span style='mso-spacerun:yes'>ï¿½ </span><span
style='mso-spacerun:yes'>ï¿½</span></p>

<p class=MsoNormal><i><o:p>&nbsp;</o:p></i></p>

<p class=MsoNormal><i><o:p>&nbsp;</o:p></i></p>

<p class=MsoNormal><!--[if gte vml 1]><v:rect id="Rectangle_x0020_22" o:spid="_x0000_s1027"
 style='position:absolute;margin-left:-7.5pt;margin-top:4.55pt;width:1380.75pt;
 height:302.25pt;z-index:-251654144;visibility:visible;mso-wrap-style:square;
 mso-width-percent:0;mso-height-percent:0;mso-wrap-distance-left:9pt;
 mso-wrap-distance-top:0;mso-wrap-distance-right:9pt;
 mso-wrap-distance-bottom:0;mso-position-horizontal:absolute;
 mso-position-horizontal-relative:text;mso-position-vertical:absolute;
 mso-position-vertical-relative:text;mso-width-percent:0;mso-height-percent:0;
 mso-width-relative:margin;mso-height-relative:margin;v-text-anchor:middle'
 o:gfxdata="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
" fillcolor="#d9e2f3 [660]" strokecolor="#1f3763 [1604]" strokeweight="1pt"/><![endif]--><![if !vml]><span
style='mso-ignore:vglayout;position:absolute;z-index:-1895821312;margin-left:
-11px;margin-top:5px;width:1843px;height:406px'><img width=1843 height=406
src="privilegesPagingSegmentationFinalish_files/image022.png" v:shapes="Rectangle_x0020_22"></span><![endif]><i><o:p></o:p></i></p>

<p class=MsoNormal>For those interested in seeing things directly in Kernel
code, letï¿½s look at the struct mm_struct, which contains the entry point for a processï¿½s
translation tables.<span style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoNormal><i><o:p>&nbsp;</o:p></i></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_7" o:spid="_x0000_i1026" type="#_x0000_t75" style='width:513pt;
 height:211.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="privilegesPagingSegmentationFinalish_files/image023.png"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=684 height=282
src="privilegesPagingSegmentationFinalish_files/image024.jpg" v:shapes="Picture_x0020_7"><![endif]></span><i><o:p></o:p></i></p>

<p class=MsoNormal><i><o:p>&nbsp;</o:p></i></p>

<p class=MsoNormal>As of Linux v5.8, this struct is defined in the file<i> <a
href="https://elixir.bootlin.com/linux/v5.8/source/include/linux/mm_types.h#L384">include/linux/mm_types.h</a>.<span
style='mso-spacerun:yes'>ï¿½ </span></i>Each process has a mm_struct associated
with it, called a memory descriptor.<span style='mso-spacerun:yes'>ï¿½ </span>A
processï¿½s memory descriptor is a summary of that processï¿½s memory.<span
style='mso-spacerun:yes'>ï¿½ </span>If you look inside this struct, we see a
field called pgd.<span style='mso-spacerun:yes'>ï¿½ </span>This is a pointer to
that processï¿½s Page Global Directory, which is the first layer in that
processï¿½s series of translation tables.<i><span style='mso-spacerun:yes'>ï¿½
</span><o:p></o:p></i></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>It turns out that each entry within the translation tables
mentioned above isnï¿½t just a reference to a translation table in the next
level.<span style='mso-spacerun:yes'>ï¿½ </span>Instead, each entry in each table
also contains the following fields:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l2 level1 lfo8'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>A present flag.<span style='mso-spacerun:yes'>ï¿½
</span>If this is set, the corresponding page is in main memory.<span
style='mso-spacerun:yes'>ï¿½ </span>Otherwise, the page is not in memory and a
Page Fault Exception needs to be thrown</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l2 level1 lfo8'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>An accessed flag which is set each time the
paging unit addresses the corresponding page.<span style='mso-spacerun:yes'>ï¿½
</span>This is used by the Kernel when determining which page to swap out when
we need to insert a new page into memory</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l2 level1 lfo8'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>A dirty flag which only applies to Page Table
entries (the last table in our series of translation tables).<span
style='mso-spacerun:yes'>ï¿½ </span>This is set by the Kernel whenever a write
operation is performed on the corresponding page.<span
style='mso-spacerun:yes'>ï¿½ </span>This is also used by the Kernel when
determining which page to swap out when a new page needs to be inserted into
memory</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l2 level1 lfo8'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>A read/write flag which contains the access
rights of the corresponding page.<span style='mso-spacerun:yes'>ï¿½ </span>If it
is 0, the corresponding page can only be read.<span style='mso-spacerun:yes'>ï¿½
</span>If it is 1, the corresponding page can be read and written</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l2 level1 lfo8'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b>A user/supervisor flag</b>.<span
style='mso-spacerun:yes'>ï¿½ </span>This is the privilege level required to
access the page.<span style='mso-spacerun:yes'>ï¿½ </span>If the flag is 0, the
page can only be addressed when the CPL is less than 3 (Kernel Mode).<span
style='mso-spacerun:yes'>ï¿½ </span>If the flag is 1, then the page always be
addressed.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>For a more in-depth look at the structure of translation
tables, checkout the file <a
href="https://elixir.bootlin.com/linux/v5.8/source/arch/x86/include/asm/pgtable_types.h"><i>arch/x86/include/asm/pgtable_types.h</i></a>.<span
style='mso-spacerun:yes'>ï¿½ </span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>As you may have guessed, the user/supervisor flag is what weï¿½re
interested in (and is the final piece of the privileges puzzle, as far as weï¿½re
concerned).<span style='mso-spacerun:yes'>ï¿½ </span><o:p></o:p></p>

<p class=MsoNormal><!--[if gte vml 1]><v:rect id="Rectangle_x0020_23" o:spid="_x0000_s1026"
 style='position:absolute;margin-left:-10.5pt;margin-top:4pt;width:1357.5pt;
 height:338.25pt;z-index:-251653120;visibility:visible;mso-wrap-style:square;
 mso-width-percent:0;mso-height-percent:0;mso-wrap-distance-left:9pt;
 mso-wrap-distance-top:0;mso-wrap-distance-right:9pt;
 mso-wrap-distance-bottom:0;mso-position-horizontal:absolute;
 mso-position-horizontal-relative:text;mso-position-vertical:absolute;
 mso-position-vertical-relative:text;mso-width-percent:0;mso-height-percent:0;
 mso-width-relative:margin;mso-height-relative:margin;v-text-anchor:middle'
 o:gfxdata="UEsDBBQABgAIAAAAIQC2gziS/gAAAOEBAAATAAAAW0NvbnRlbnRfVHlwZXNdLnhtbJSRQU7DMBBF
90jcwfIWJU67QAgl6YK0S0CoHGBkTxKLZGx5TGhvj5O2G0SRWNoz/78nu9wcxkFMGNg6quQqL6RA
0s5Y6ir5vt9lD1JwBDIwOMJKHpHlpr69KfdHjyxSmriSfYz+USnWPY7AufNIadK6MEJMx9ApD/oD
OlTrorhX2lFEilmcO2RdNtjC5xDF9pCuTyYBB5bi6bQ4syoJ3g9WQ0ymaiLzg5KdCXlKLjvcW893
SUOqXwnz5DrgnHtJTxOsQfEKIT7DmDSUCaxw7Rqn8787ZsmRM9e2VmPeBN4uqYvTtW7jvijg9N/y
JsXecLq0q+WD6m8AAAD//wMAUEsDBBQABgAIAAAAIQA4/SH/1gAAAJQBAAALAAAAX3JlbHMvLnJl
bHOkkMFqwzAMhu+DvYPRfXGawxijTi+j0GvpHsDYimMaW0Yy2fr2M4PBMnrbUb/Q94l/f/hMi1qR
JVI2sOt6UJgd+ZiDgffL8ekFlFSbvV0oo4EbChzGx4f9GRdb25HMsYhqlCwG5lrLq9biZkxWOiqY
22YiTra2kYMu1l1tQD30/bPm3wwYN0x18gb45AdQl1tp5j/sFB2T0FQ7R0nTNEV3j6o9feQzro1i
OWA14Fm+Q8a1a8+Bvu/d/dMb2JY5uiPbhG/ktn4cqGU/er3pcvwCAAD//wMAUEsDBBQABgAIAAAA
IQD/PzVFmgIAAK8FAAAOAAAAZHJzL2Uyb0RvYy54bWysVEtv2zAMvg/YfxB0X+14ydIGdYogRYYB
XVv0gZ5VWYoNSKImKXGyXz9Kdtygjx2GXWSRIj+Sn0meX+y0IlvhfAOmpKOTnBJhOFSNWZf08WH1
5ZQSH5ipmAIjSroXnl7MP386b+1MFFCDqoQjCGL8rLUlrUOwsyzzvBaa+ROwwuCjBKdZQNGts8qx
FtG1yoo8/5a14CrrgAvvUXvZPdJ5wpdS8HAjpReBqJJibiGdLp3P8czm52y2dszWDe/TYP+QhWaN
waAD1CULjGxc8wZKN9yBBxlOOOgMpGy4SDVgNaP8VTX3NbMi1YLkeDvQ5P8fLL/e3jrSVCUtvlJi
mMZ/dIesMbNWgqAOCWqtn6Hdvb11veTxGqvdSafjF+sgu0TqfiBV7ALhqBxNi3FeTJB8jo/j4mwy
nU4ibPbib50P3wVoEi8ldZhAYpNtr3zoTA8mMZwH1VSrRqkkxFYRS+XIluFPZpwLE0bJXW30T6g6
PTZL3v9uVGNTdOrTgxqzSU0XkVJuR0GyyEBXc7qFvRIxtDJ3QiJ5WGWRAg4Ib3PxNatEp558GDMB
RmSJxQ3YXTEfYHfs9PbRVaSuH5zzvyXWOQ8eKTKYMDjrxoB7D0Ahw33kzh4pO6ImXp+h2mNrOehm
zlu+avDvXjEfbpnDIcOOwMURbvCQCtqSQn+jpAb3+z19tMfex1dKWhzakvpfG+YEJeqHwak4G43H
ccqTMJ5MCxTc8cvz8YvZ6CVgy4xwRVmertE+qMNVOtBPuF8WMSo+McMxdkl5cAdhGbplghuKi8Ui
meFkWxauzL3lETyyGrv3YffEnO1bPOB4XMNhwNnsVad3ttHTwGITQDZpDF547fnGrZCatd9gce0c
y8nqZc/O/wAAAP//AwBQSwMEFAAGAAgAAAAhAIgPBUjgAAAACgEAAA8AAABkcnMvZG93bnJldi54
bWxMj8FOwzAQRO9I/IO1SFxQ6yRqrRDiVKESBw4cWvIB29gkEfE6xG4b/p7lBKfd1Yxm35S7xY3i
YucweNKQrhMQllpvBuo0NO8vqxxEiEgGR09Ww7cNsKtub0osjL/SwV6OsRMcQqFADX2MUyFlaHvr
MKz9ZIm1Dz87jHzOnTQzXjncjTJLEiUdDsQfepzsvrft5/HsNOxf022jvt7S+rmOD43D7jCpWuv7
u6V+AhHtEv/M8IvP6FAx08mfyQQxalhlKXeJGnIerGfqccPbSYPKN1uQVSn/V6h+AAAA//8DAFBL
AQItABQABgAIAAAAIQC2gziS/gAAAOEBAAATAAAAAAAAAAAAAAAAAAAAAABbQ29udGVudF9UeXBl
c10ueG1sUEsBAi0AFAAGAAgAAAAhADj9If/WAAAAlAEAAAsAAAAAAAAAAAAAAAAALwEAAF9yZWxz
Ly5yZWxzUEsBAi0AFAAGAAgAAAAhAP8/NUWaAgAArwUAAA4AAAAAAAAAAAAAAAAALgIAAGRycy9l
Mm9Eb2MueG1sUEsBAi0AFAAGAAgAAAAhAIgPBUjgAAAACgEAAA8AAAAAAAAAAAAAAAAA9AQAAGRy
cy9kb3ducmV2LnhtbFBLBQYAAAAABAAEAPMAAAABBgAAAAA=
" fillcolor="#d9e2f3 [660]" strokecolor="#1f3763 [1604]" strokeweight="1pt"/><![endif]--><![if !vml]><span
style='mso-ignore:vglayout;position:absolute;z-index:-1895820288;margin-left:
-15px;margin-top:4px;width:1812px;height:453px'><img width=1812 height=453
src="privilegesPagingSegmentationFinalish_files/image025.png" v:shapes="Rectangle_x0020_23"></span><![endif]><o:p></o:p></p>

<p class=MsoNormal>Letï¿½s take a look at the code in the Kernel that actually
performs the access check on page table entries.<span
style='mso-spacerun:yes'>ï¿½ </span><span style='mso-spacerun:yes'>ï¿½ï¿½</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_2" o:spid="_x0000_i1025" type="#_x0000_t75" style='width:468pt;
 height:209.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="privilegesPagingSegmentationFinalish_files/image026.png"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=624 height=279
src="privilegesPagingSegmentationFinalish_files/image027.jpg" v:shapes="Picture_x0020_2"><![endif]></span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>You can find the above function in the file <i><a
href="https://elixir.bootlin.com/linux/v5.8/source/arch/x86/include/asm/pgtable.h#L1420">/arch/x86/include/asm/pgtable.h</a>.<span
style='mso-spacerun:yes'>ï¿½ </span></i>It takes a page table entry, ï¿½ptevalï¿½, and
the boolean ï¿½writeï¿½, which descibes whether the access is a write or a
read.<span style='mso-spacerun:yes'>ï¿½ </span>The variable ï¿½need_pte_bitsï¿½ is
constructed from the bit masks defined by the macros ï¿½_PAGE_PRESENTï¿½, ï¿½_PAGE_USERï¿½,
and ï¿½_PAGE_RW.ï¿½<span style='mso-spacerun:yes'>ï¿½ </span>This variable is then
compared with the page table entry that was passed in as input.<span
style='mso-spacerun:yes'>ï¿½ </span>If we find that the page table entry does not
have these flags properly set, the function returns false and access is denied.
<span style='mso-spacerun:yes'>ï¿½ï¿½</span>Sidenote: If youï¿½re interested in the
function ï¿½__pkru_allows_pkeyï¿½, then check out the Linux manual page for the ï¿½<a
href="https://man7.org/linux/man-pages/man7/pkeys.7.html">pkeys(7)</a>ï¿½ system
call.<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc61449163">Quick Recap of Privilege Checking</a></h1>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l9 level1 lfo14'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The segmentation unit loads the segment selector
for the segment containing the currently executing programï¿½s instructions into
the CS register.<span style='mso-spacerun:yes'>ï¿½ </span>This will be either the
kernel code segment or the user code segment.<span style='mso-spacerun:yes'>ï¿½
</span>The current privilege level (CPL) of the CPU is extracted from this
segment selector.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l9 level1 lfo14'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>When the currently executing process tries to
access an address, the segmentation unit checks that the CPL of the CPU is less
than or equal to the DPL of the segment containing the address we are accessing.<span
style='mso-spacerun:yes'>ï¿½ </span>As a reminder, the DPL of a segment is stored
in that segmentï¿½s descriptor, located in either the GDT or the LDT.<span
style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l9 level1 lfo14'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The segmentation unit also makes sure the RPL,
which is associated with the segment selector of the address as opposed to the
segment itself, is less than or equal to the DPL of the segment associated with
the logical address being accessed.<span style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l9 level1 lfo14'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>ï¿½<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The paging unit checks the user/supervisor flag
of the page table entry associated with the page being accessing.<span
style='mso-spacerun:yes'>ï¿½ </span>Assuming this flag is 0, the page can only be
accessed if CPL &lt; 3.<span style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Segmentation and paging work together to provide protection
in the Linux Kernel.<span style='mso-spacerun:yes'>ï¿½ </span>Access to a page
will only be allowed if the segmentation privilege checks pass and then the
paging privilege check passes.<span style='mso-spacerun:yes'>ï¿½ </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<w:Sdt SdtDocPart="t" DocPartType="Bibliographies" DocPartUnique="t"
 ID="371427479">
 <h1><a name="_Toc61449164">References</a><span style='font-size:11.0pt;
 mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
 Calibri;mso-fareast-theme-font:minor-latin;mso-hansi-font-family:Calibri;
 mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";
 mso-bidi-theme-font:minor-bidi;color:windowtext'><w:sdtPr></w:sdtPr></span></h1>
 <w:Sdt Bibliography="t" ID="-573587230">
  <p class=MsoNormal><!--[if supportFields]><span style='mso-element:field-begin'></span><span
  style='mso-spacerun:yes'>ï¿½</span>BIBLIOGRAPHY <span style='mso-element:field-separator'></span><![endif]--><span
  style='mso-no-proof:yes'><o:p></o:p></span><w:sdtPr></w:sdtPr></p>
  <table class=MsoNormalTable border=0 cellpadding=0 width="100%"
   style='width:100.0%;mso-cellspacing:1.5pt;mso-yfti-tbllook:1184'>
   <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
    <td width="1%" valign=top style='width:1.0%;padding:.75pt .75pt .75pt .75pt'>
    <p class=MsoBibliography><span style='mso-no-proof:yes'>[1] </span><span
    style='font-size:12.0pt;mso-no-proof:yes'><o:p></o:p></span></p>
    </td>
    <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
    <p class=MsoBibliography><span style='mso-no-proof:yes'>D. P. Bovet and M.
    Cesati, Understanding the Linux Kernel, 3rd Edition, O'Reilly Media, Inc.,
    2005. <o:p></o:p></span></p>
    </td>
   </tr>
   <tr style='mso-yfti-irow:1' xmlns="">
    <td width="1%" valign=top style='width:1.0%;padding:.75pt .75pt .75pt .75pt'>
    <p class=MsoBibliography><span style='mso-no-proof:yes'>[2] <o:p></o:p></span></p>
    </td>
    <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
    <p class=MsoBibliography><span style='mso-no-proof:yes'>&quot;Intel
    8086,&quot; Wikipedia, [Online]. Available:
    https://en.wikipedia.org/wiki/Intel_8086. [Accessed 13 January 2021].<o:p></o:p></span></p>
    </td>
   </tr>
   <tr style='mso-yfti-irow:2' xmlns="">
    <td width="1%" valign=top style='width:1.0%;padding:.75pt .75pt .75pt .75pt'>
    <p class=MsoBibliography><span style='mso-no-proof:yes'>[3] <o:p></o:p></span></p>
    </td>
    <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
    <p class=MsoBibliography><span style='mso-no-proof:yes'>D. P. Bovet and M.
    Cesati, &quot;Figure 2-5. Translating a logical address,&quot; in <i>Understanding
    the Linux Kernel, 3rd Edition</i>, O'Reilly Media, Inc., 2005. <o:p></o:p></span></p>
    </td>
   </tr>
   <tr style='mso-yfti-irow:3' xmlns="">
    <td width="1%" valign=top style='width:1.0%;padding:.75pt .75pt .75pt .75pt'>
    <p class=MsoBibliography><span style='mso-no-proof:yes'>[4] <o:p></o:p></span></p>
    </td>
    <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
    <p class=MsoBibliography><span style='mso-no-proof:yes'>&quot;CPL vs. DPL
    vs. RPL,&quot; openwares.net, 04 December 2020. [Online]. Available:
    https://openwares.net/2019/02/09/cpl-vs-dpl-vs-rpl/. [Accessed 12 January
    2021].<o:p></o:p></span></p>
    </td>
   </tr>
   <tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes' xmlns="">
    <td width="1%" valign=top style='width:1.0%;padding:.75pt .75pt .75pt .75pt'>
    <p class=MsoBibliography><span style='mso-no-proof:yes'>[5] <o:p></o:p></span></p>
    </td>
    <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
    <p class=MsoBibliography><span style='mso-no-proof:yes'>&quot;Four-level
    page tables merged,&quot; LWN.net, 05 January 2005. [Online]. Available:
    https://lwn.net/Articles/117749/. [Accessed 12 January 2021].<o:p></o:p></span></p>
    </td>
   </tr>
  </table>
  <p class=MsoNormal><span style='mso-fareast-font-family:"Times New Roman";
  mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal><!--[if supportFields]><b><span style='mso-no-proof:yes'><span
  style='mso-element:field-end'></span></span></b><![endif]--><o:p>&nbsp;</o:p></p>
 </w:Sdt></w:Sdt>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal><b><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoListParagraph style='margin-left:1.0in;mso-add-space:auto'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
